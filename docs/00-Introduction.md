# Introduction

**BaseException** - библиотека унификации исключений для *PHP*.

**BaseException** решает задачи:

1. Метаданные исключений.
2. Шаблонизация сообщений.
2. Аспектирование исключений.
3. Нормализация исключений при помощи "контейнеров".
4. Регистрация исключений в глобальном реестре.

## Метаданные исключений и шаблонизация

При анализе исключений важно иметь ясное представление о том, что произошло.
Для этого необходимо хранить метаданные исключения, которые помогут в дальнейшем анализе.
Данная библиотека реализует возможность создавать исключения с контекстом, который содержит метаданные исключения.

Метаданные исключения представляют собой ассоциативный массив,
элементами которого могут быть только простые типы данных.

## Поддержка шаблонов сообщений

**BaseException** поддерживает концепцию *шаблона сообщения* (начиная с версии 2.0). 
Шаблон сообщения - это строка, содержащая *placeholders*, 
которые заменяются на значения данных из контекста исключения. 
Формат шаблона соответствует [PSR-3](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-3-logger-interface.md).

Когда исключение создаётся, в конструктор передаются данные, 
которые будут использоваться для замены *placeholders* в шаблоне сообщения.
Конструктор использует шаблон и генерирует описание исключения по шаблону и метаданным.

Шаблон исключения позволяет добиться нескольких важных бенефитов:
* Возможность перевода сообщений об ошибках на разные языки, основываясь на шаблоне.
* Возможность группировать исключения по шаблону.

Шаблонизация сообщений позволяет записать в журнал не только результирующее сообщение, 
но и данные, которые были использованы для его формирования:

```php
    $exception = new BaseException(['template' => 'User {user} from {ip} is not allowed', 'user' => $user, 'ip' => $ip]);
    $logger->error($exception);
```

Это даёт возможность в дальнейшем анализировать журнал и понимать, 
какие данные были использованы для формирования сообщения об ошибке, 
группировать исключения по шаблону, либо делать поиск по метаданным.

## Аспектирование исключений

Аспект - это класс характеристик исключения, который позволяет обобщать код и задачи по обработке исключений. 
Например, аспекты позволяют ответить на вопросы:

- кто виноват: программист или система;
- что делать: игнорировать проблему или немедленно решать.

## Нормализация исключений

Нормализация исключений - это поддержка системой ограниченного числа выброшенных исключений. 
Она может достигаться такими способами:

1. Наследование.
2. Привидение к контейнеру.
3. Интерфейсы.

Например, привидение к контейнеру:

```php
    try
    {
        ...
    }
    catch(\Exception $e)
    {
        // BaseException наследует характеристики $e
        throw new BaseException($e);
    }
```

## Регистрация исключений

**BaseException** позволяет регистрировать исключения в глобальном реестре до того, как исключение, будет выброшено.
На текущий момент эта возможность существует, но не используется на практике.
Тем не менее в некоторых ситуациях, она может стать дополнительным инструментом для анализа исключений.

## Небольшая библиотека готовых исключений

Кроме реализации сервисного кода, **BaseException** так же содержит небольшой список готовых классов для создания типичных исключений.
